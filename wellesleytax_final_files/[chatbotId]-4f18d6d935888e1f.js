(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8731],{62859:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/widget/[chatbotId]",function(){return s(76483)}])},9039:function(e,t,s){"use strict";s.d(t,{j:function(){return WidgetLayout}});var r=s(85893),n=s(93717),a=s(81136),i=s(81647),o=s(67294);let WidgetLayout=e=>{let{children:t}=e,s=(0,o.useContext)(i.Z);return s.isLoading?(0,r.jsx)(n.k,{h:"100vh",w:"100vw",alignItems:"center",justifyContent:"center",children:(0,r.jsx)(a.$,{})}):(0,r.jsx)(r.Fragment,{children:t})}},76483:function(e,t,s){"use strict";s.r(t),s.d(t,{OwnSiteWidget:function(){return OwnSiteWidget},default:function(){return Page}});var r=s(85893),n=s(9039),a=s(57747),i=s(93717),o=s(13990),l=s(81136),d=s(71293),c=s(89993),u=s(5460),x=s(36948);let WonderChatIcon=e=>{var t,s;return(0,r.jsxs)(x.J,{fill:"none",viewBox:"0 0 37 37",h:null!==(t=e.h)&&void 0!==t?t:"34px",w:null!==(s=e.w)&&void 0!==s?s:"37px",xmlns:"http://www.w3.org/2000/svg",...e,children:[(0,r.jsxs)("g",{fill:"#FFFCFD",filter:"url(#a)",children:[(0,r.jsx)("path",{d:"m22.25 21.78 5.99 10.106c1.448 2.441 5.218 1.423 5.218-1.41v-8.695H22.25Z"}),(0,r.jsx)("path",{d:"M36.26 13.44C36.26 6.379 30.49.653 23.37.653H13.282C6.162.652.392 6.378.392 13.441v1.112c0 7.063 5.77 12.788 12.89 12.788H23.37c7.12 0 12.89-5.726 12.89-12.788V13.44Z"})]}),(0,r.jsxs)("g",{filter:"url(#b)",children:[(0,r.jsx)("path",{fill:"url(#c)",d:"M25.561 10.543a.557.557 0 0 0-1.02 0l-.858 1.945a.559.559 0 0 1-.285.285l-1.938.86a.56.56 0 0 0 0 1.024l1.938.861a.559.559 0 0 1 .285.285l.858 1.945a.557.557 0 0 0 1.02 0l.859-1.945a.559.559 0 0 1 .284-.285l1.938-.86a.56.56 0 0 0 0-1.024l-1.938-.861a.559.559 0 0 1-.284-.285l-.859-1.945Z"}),(0,r.jsx)("path",{fill:"url(#d)",d:"M14.402 14.146a2.245 2.245 0 0 0 2.242 2.248 2.245 2.245 0 0 0 2.242-2.248 2.245 2.245 0 0 0-2.242-2.25 2.245 2.245 0 0 0-2.242 2.25Z"}),(0,r.jsx)("path",{fill:"url(#e)",d:"M7.677 14.146a2.245 2.245 0 0 0 2.242 2.248 2.245 2.245 0 0 0 2.242-2.248 2.245 2.245 0 0 0-2.242-2.25 2.245 2.245 0 0 0-2.242 2.25Z"})]}),(0,r.jsxs)("defs",{children:[(0,r.jsxs)("linearGradient",{id:"c",x1:18.326,x2:18.326,y1:10.21,y2:16.652,gradientUnits:"userSpaceOnUse",children:[(0,r.jsx)("stop",{}),(0,r.jsx)("stop",{offset:1})]}),(0,r.jsxs)("linearGradient",{id:"d",x1:18.326,x2:18.326,y1:10.21,y2:16.652,gradientUnits:"userSpaceOnUse",children:[(0,r.jsx)("stop",{}),(0,r.jsx)("stop",{offset:1})]}),(0,r.jsxs)("linearGradient",{id:"e",x1:18.326,x2:18.326,y1:10.21,y2:16.652,gradientUnits:"userSpaceOnUse",children:[(0,r.jsx)("stop",{}),(0,r.jsx)("stop",{offset:1})]}),(0,r.jsxs)("filter",{id:"a",width:35.869,height:35.609,x:.392,y:.652,colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse",children:[(0,r.jsx)("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),(0,r.jsx)("feBlend",{in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),(0,r.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,r.jsx)("feOffset",{dy:3}),(0,r.jsx)("feGaussianBlur",{stdDeviation:2}),(0,r.jsx)("feComposite",{in2:"hardAlpha",k2:-1,k3:1,operator:"arithmetic"}),(0,r.jsx)("feColorMatrix",{values:"0 0 0 0 1 0 0 0 0 1 0 0 0 0 1 0 0 0 0.25 0"}),(0,r.jsx)("feBlend",{in2:"shape",result:"effect1_innerShadow_66_6341"})]}),(0,r.jsxs)("filter",{id:"b",width:21.298,height:10.871,x:7.677,y:10.21,colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse",children:[(0,r.jsx)("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),(0,r.jsx)("feBlend",{in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),(0,r.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,r.jsx)("feOffset",{dy:3}),(0,r.jsx)("feGaussianBlur",{stdDeviation:2}),(0,r.jsx)("feComposite",{in2:"hardAlpha",k2:-1,k3:1,operator:"arithmetic"}),(0,r.jsx)("feColorMatrix",{values:"0 0 0 0 1 0 0 0 0 1 0 0 0 0 1 0 0 0 0.25 0"}),(0,r.jsx)("feBlend",{in2:"shape",result:"effect1_innerShadow_66_6341"})]})]})]})};var h=s(67294),p=s(11163),g=s(76236),f=s(79250),m=s(1679),w=s(33299),b=s(31858),j=s(81647);let y=(0,h.lazy)(()=>Promise.all([s.e(5445),s.e(5970),s.e(5937),s.e(5447),s.e(35),s.e(6893),s.e(2664),s.e(4201),s.e(385),s.e(8362),s.e(7688),s.e(2209),s.e(9362),s.e(2969),s.e(8311)]).then(s.bind(s,92969)));function OwnSiteWidget(e){let{chatbotId:t}=e,s=(0,w.useSession)(),n=(0,p.useRouter)(),a=(0,h.useContext)(j.Z);if(!n.query.chatbotId&&"/escalated"!==n.pathname&&"/chatlogs"!==n.pathname&&!n.query.widget&&!n.query.embed&&!a.isWhitelabelled){var i;return(0,r.jsx)(r.Fragment,{children:(null==s?void 0:null===(i=s.data)||void 0===i?void 0:i.user)&&(0,r.jsx)(Page,{chatbotId:t,isOwnSite:!0})})}return null}function Page(e){var t,s,n,x;let{chatbotId:w,isOwnSite:v=!1}=e,C=(0,h.useContext)(j.Z),S=(0,h.useRef)(null),O=(0,h.useRef)(null),[k,M]=(0,h.useState)(!1),[I,W]=(0,h.useState)(!1),[E,F]=(0,h.useState)(0),[L,_]=(0,h.useState)(!1),[B,R]=(0,h.useState)("calc(100% - 80px)"),[z,U]=(0,h.useState)("40px"),q=(0,p.useRouter)(),T=q.query.chatbotId||w,[G,A]=(0,f.u)(),{data:N}=g.S.chatbot.getChatBotPublicQuery.useQuery({chatbotId:null!=T?T:"",passphrase:q.query.passphrase,embedUrl:q.query.embedUrl},{enabled:!!T,refetchOnWindowFocus:!1,refetchInterval:1/0,refetchOnMount:!1,refetchOnReconnect:!1,staleTime:1/0});(0,h.useEffect)(()=>{if(N){let onMessage=e=>{if(e.origin!==window.origin)try{let{type:t}=JSON.parse(e.data);"showGreeting"===t&&!I&&N.shouldSpontaneouslyGreet&&_(!0)}catch(e){}};return window.addEventListener("message",onMessage),()=>{window.removeEventListener("message",onMessage)}}},[N]),(0,h.useEffect)(()=>{L&&A(!1)},[L]),(0,h.useEffect)(()=>{q.query.isInitiallyOpen&&W(!0)},[q.query.isInitiallyOpen]),(0,h.useEffect)(()=>{O.current&&clearTimeout(O.current),S.current&&clearTimeout(S.current),L&&(_(!1),window.parent.postMessage((0,b.h)("showChat",{isOpen:!1}),"*")),I&&window.parent.postMessage((0,b.h)("chatbotAcknowledged"),"*"),!I&&k&&window.parent.postMessage((0,b.h)("changeWrapperMargin",{}),"*"),I?window.parent.postMessage((0,b.h)("showChat",{isOpen:I}),"*"):S.current=setTimeout(()=>{window.parent.postMessage((0,b.h)("showChat",{isOpen:I}),"*")},500),I?O.current=setTimeout(()=>{k?R("100%"):v?(R("622px"),U("384px")):R("calc(100% - 20px)")},10):(v&&U("40px"),R("auto"))},[I,k]),(0,h.useEffect)(()=>{let handleMessage=e=>{if(e.origin!==window.origin)try{let{type:t}=JSON.parse(e.data);"fullscreen"===t?M(!0):M(!1),"toggleChat"===t&&W(!I)}catch(e){}};return window.addEventListener("message",handleMessage),window.parent.postMessage((0,b.h)("requestWidth"),"*"),()=>{window.removeEventListener("message",handleMessage)}},[I]);let P=null!==(x=null==N?void 0:N.colorTheme)&&void 0!==x?x:"brand.200",Z=q.query.greeting,D=q.query.placement;q.query.widgetSize;let H=q.query.widgetButtonSize,[J="brand",Q="200"]=null==P?void 0:P.split("."),V="900"===Q?"900":String(Number(Q)+100);return N?(0,r.jsxs)(i.k,{sx:{bottom:"0",display:"flex",flexDirection:"column",position:"fixed",justifyContent:"flex-end",..."left"===D?{left:k?void 0:"6px"}:{right:k?void 0:"6px"},alignItems:"left"===D?"start":"end",maxWidth:k?"100%":v?z:"584px",background:"transparent",height:B,width:k?"100%":"calc(100% - 30px)",zoom:{base:"0.9",md:"normal",lg:"normal"}},children:[(0,r.jsx)(h.Suspense,{fallback:(0,r.jsx)(i.k,{w:"full",h:"full",justifyContent:"center",alignItems:"center",sx:I?{opacity:"1",transformOrigin:"left"===D?"left bottom":"right bottom",transition:"width 200ms ease 0s, height 200ms ease 0s, max-height 200ms ease 0s, transform 300ms cubic-bezier(0, 1.2, 1, 1) 0s, opacity 83ms ease-out 0s",pointerEvents:"all"}:{transformOrigin:"left"===D?"left bottom":"right bottom",transition:"width 200ms ease 0s, height 200ms ease 0s, max-height 200ms ease 0s, transform 300ms cubic-bezier(0, 1.2, 1, 1) 0s, opacity 83ms ease-out 0s",transform:"scale(0)",opacity:"0",pointerEvents:"none"},children:(0,r.jsxs)(o.Z,{borderRadius:"3xl",w:"full",h:"full",alignItems:"center",justifyContent:"center",flexDir:"row",children:[(0,r.jsx)(l.$,{mr:"4"}),(0,r.jsx)(d.x,{layerStyle:"header",children:"Loading chatbot..."})]})}),children:(0,r.jsx)(y,{isWidget:!0,showChat:I,setShowChat:e=>{e&&F(0),W(e)},isWidgetFullscreen:k,chatbotDetails:N,isOwnSite:v,setUnreadLiveChatMessages:F})}),(0,r.jsx)(a.xu,{ref:G,children:L&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(a.xu,{as:"span",position:"absolute",right:"0px",top:"-8px",bgColor:"gray.400",borderRadius:"full",w:"20px",h:"20px",alignItems:"center",justifyContent:"center",display:"flex",cursor:"pointer",onClick:()=>{_(!1),window.parent.postMessage((0,b.h)("chatbotAcknowledged"),"*"),window.parent.postMessage((0,b.h)("showChat",{isOpen:!1}),"*")},zIndex:999,children:(0,r.jsx)(m.T,{boxSize:"8px",color:"white"})}),(0,r.jsx)(a.xu,{bgColor:"white",p:"3",borderRadius:"lg",boxShadow:"lg",borderWidth:"thin",borderColor:"gray.400",wordBreak:"break-word",mr:"2",css:{"&::-webkit-scrollbar":{display:"none"}},children:(0,r.jsx)(d.x,{fontSize:"14px",lineHeight:"1.5em",maxHeight:"4.5em",overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",sx:{lineClamp:3,WebkitLineClamp:3,WebkitBoxOrient:"vertical"},children:Z||((null==N?void 0:N.greetingMessage)?N.greetingMessage:"Hi, I'm an AI assistant, ".concat(null==N?void 0:N.name,". Feel free to ask me any questions!"))})})]})}),(0,r.jsx)(c.h,{shadow:"md",sx:{margin:"left"===D?"0px 0px 20px 20px":"0 20px 20px 20px",borderRadius:"99px",width:"extraLarge"===H?"84px":"large"===H?"72px":"60px",height:"extraLarge"===H?"84px":"large"===H?"72px":"60px",padding:"30px",bgGradient:P.startsWith("#")?"linear-gradient(180deg, ".concat(P," 0%, ").concat(P," 81.85%)"):"linear-gradient(180deg, ".concat(J,".").concat(Q," 0%, ").concat(J,".").concat(V," 81.85%)"),marginTop:"12px",_hover:{transition:"transform 250ms cubic-bezier(0.33, 0.00, 0.00, 1.00)",transform:"scale(1.05)"},_active:{transition:"transform 250ms cubic-bezier(0.33, 0.00, 0.00, 1.00)",transform:"scale(0.85)",bgGradient:P.startsWith("#")?"linear-gradient(180deg, ".concat(P," 0%, ").concat(P," 81.85%)"):"linear-gradient(180deg, ".concat(J,".").concat(Q," 0%, ").concat(J,".").concat(V," 81.85%)")},display:k&&I?"none":"flex"},"aria-label":"Open WonderChat",icon:(0,r.jsxs)(r.Fragment,{children:[!!E&&!I&&(0,r.jsx)(i.k,{bgColor:"red",zIndex:4,color:"white",h:"4",w:"4",fontSize:"xs",fontWeight:"semibold",p:"11px",justifyContent:"center",alignItems:"center",borderRadius:"full",position:"absolute",as:"span",top:"-5px",right:"-5px",children:E}),(null==N?void 0:null===(s=N.owner)||void 0===s?void 0:null===(t=s.EnabledFeatureFlags)||void 0===t?void 0:t.find(e=>"REMOVE_POWERED_BY"===e.featureName))&&(null==N?void 0:N.usePictureAsWidgetIcon)&&(null==N?void 0:N.pictureUrl)?(0,r.jsx)(u.E,{alt:N.name,src:null==N?void 0:N.pictureUrl,sx:{position:"absolute",opacity:I?0:1,transition:"transform 0.16s linear 0s, opacity 0.08s linear 0s",transform:I?"rotate(30deg)":"rotate(0deg)"},borderRadius:"full",w:"full",h:"full"}):C.isWhitelabelled?(0,r.jsx)(u.E,{alt:C.name,src:C.lightLogo,sx:{position:"absolute",opacity:I?0:1,transition:"transform 0.16s linear 0s, opacity 0.08s linear 0s",transform:I?"rotate(30deg)":"rotate(0deg)"},w:"extraLarge"===H?"46px":"large"===H?"40px":"34px",h:"extraLarge"===H?"51px":"large"===H?"44px":"37px"}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(WonderChatIcon,{sx:{position:"absolute",opacity:I?0:1,transition:"transform 0.16s linear 0s, opacity 0.08s linear 0s",transform:I?"rotate(30deg)":"rotate(0deg)"},w:"extraLarge"===H?"46px":"large"===H?"40px":"34px",h:"extraLarge"===H?"51px":"large"===H?"44px":"37px"}),(0,r.jsx)("style",{children:"\n@keyframes pulse {\n  0% {\n    transform: scale(1);\n    opacity: 0.75;\n  }\n  50% {\n    opacity: 0.25;\n  }\n  100% {\n    transform: scale(2);\n    opacity: 0;\n  }\n}\n"}),!I&&(0,r.jsx)(a.xu,{style:{position:"absolute",width:"extraLarge"===H?"55px":"large"===H?"48px":"40px",height:"extraLarge"===H?"55px":"large"===H?"48px":"40px",backgroundColor:(null==N?void 0:null===(n=N.colorTheme)||void 0===n?void 0:n.includes("."))?"var(--chakra-colors-".concat(null==N?void 0:N.colorTheme.replace(".","-"),")"):N.colorTheme||"brand.100",borderRadius:"50%",opacity:"0.75",zIndex:-1,animation:"pulse 4s cubic-bezier(0.4, 0, 0.6, 1) infinite"}})]}),(0,r.jsx)(m.T,{color:"white",sx:{position:"absolute",opacity:I?1:0,transition:"transform 0.16s linear 0s, opacity 0.08s linear 0s",transform:I?"rotate(0deg)":"rotate(-60deg)"},w:"extraLarge"===H?"1.4em":"large"===H?"1.2em":"1em",h:"extraLarge"===H?"1.4em":"large"===H?"1.2em":"1em"})]}),onClick:()=>{I||F(0),W(e=>!e)}})]}):(0,r.jsx)(a.xu,{})}Page.getLayout=function(e){return(0,r.jsx)(n.j,{children:e})}},31858:function(e,t,s){"use strict";s.d(t,{h:function(){return iframeMessage}});let iframeMessage=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return JSON.stringify({type:e,payload:t})}}},function(e){e.O(0,[5461,9774,2888,179],function(){return e(e.s=62859)}),_N_E=e.O()}]);